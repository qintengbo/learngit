angular.module("admin").controller("luckDrawDetailController",["$scope","$state","$rootScope","parameterService","$timeout",function(a,t,e,r,n){function s(){r.getLuckDetail(o.id).then(function(a){0==a.data.code?o.params=a.data.data:e.alert(a.data.message)})}function i(){r.getRedSet({page:1,size:9999}).then(function(a){0==a.data.code?angular.forEach(a.data.data,function(a){2==a.status&&a.endAt>e.nowDate&&o.redList.push(a)}):e.alert(a.data.message)})}var o=this;o.id=t.params.id,o.params={},""!=o.params.prize&&void 0!=o.params.prize||(o.params.prize=-2),""!=o.params.status&&void 0!=o.params.status||(o.params.status=2),o.redList=[],a.newLuck=function(){o.params.prize=parseInt(o.params.prize),r.newLuck(o.params).then(function(a){0===a.data.code?e.alert("新增成功",t.go("field.luckDrawSet",{reload:!0})):e.alert(a.data.message)})},o.id&&s(),i(),a.putLuck=function(){o.params.prize=parseInt(o.params.prize),r.putLuck(o.id,o.params).then(function(a){0===a.data.code?e.alert("编辑成功",t.go("field.luckDrawSet",{reload:!0})):e.alert(a.data.message)})},a.newOrPut=function(t){t?(o.error=!0,n(function(){o.error=!1},3e3)):o.id?a.putLuck():a.newLuck()}}]);