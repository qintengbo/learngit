angular.module("admin").controller("redSetDetailController",["$scope","$state","parameterService","$rootScope","$timeout",function(e,a,t,r,n){function d(){t.getlotteryTypeList().then(function(e){0==e.data.code?i.lotteryList=e.data.data.list:r.alert(e.data.message)})}function o(){i.params.type==-1?i.params.typeReadable="通用":angular.forEach(i.lotteryList,function(e,a){e.typeCode==i.params.type&&(i.params.typeReadable=e.name)})}var i=this;i.id=a.params.id,i.params={},i.error=!1,d(),e.redDetail=function(){t.redDetail(i.id).then(function(e){0==e.data.code?i.params=e.data.data:r.alert(e.data.message)})},i.id&&e.redDetail(),e.newRed=function(){parseInt(i.params.total)>=parseInt(i.params.submoney)?(o(),i.params.endAt&&(i.params.endAt=parseInt(i.params.endAt)+864e5-1),t.newRed(i.params).then(function(e){0==e.data.code?a.go("field.redSet",{},{reload:!0}):r.alert(e.data.message)})):r.alert("满减金额必须大于等于优惠金额")},e.putRed=function(){o(),t.putRed(i.id,i.params).then(function(e){0==e.data.code?a.go("field.redSet",{},{reload:!0}):r.alert(e.data.message)})},e.newOrPut=function(a){a?i.id?e.putRed():e.newRed():(i.error=!0,n(function(){i.error=!1},3e3))},i.activeDate=(new Date).getTime()}]);