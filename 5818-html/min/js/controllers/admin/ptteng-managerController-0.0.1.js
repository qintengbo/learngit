"use strict";angular.module("admin").controller("ManagerCtrl",["$state","$scope","$rootScope","$cookies","commonUtil","managerService","roleService",function(a,t,e,n,o,r,i){function d(a){i.batchGetRole(a).then(function(a){angular.forEach(a.data.data.roleList,function(a,e,n){t.rid_role[a.id]=a}),angular.forEach(l.list,function(a,e,n){a.role=t.rid_role[a.roleID]})})}function s(){r.getManagerList().then(function(a){0==a.data.code?(l.page={next:a.data.data.next||0,size:a.data.data.size||0,page:a.data.data.page||0,total:a.data.data.total||0},r.batchGetManager(a.data.data.ids).then(function(a){if(0==a.data.code){l.list=a.data.data.managerList;var t=[];angular.forEach(a.data.data.managerList,function(a,e,n){t.push(a.roleID)}),d(t)}else o.showErrMsg(a)})):o.showErrMsg(a)})}function c(a){i.getRoleManager(a).then(function(t){0==t.data.code?r.batchGetManager(t.data.data.ids).then(function(t){0==t.data.code?(l.list=t.data.data.managerList,d([a])):o.showErrMsg(t)}):o.showErrMsg(t)})}var l=t.vm={};t.rid_role={},l.roleList=[];var g={size:65535};s(),l["delete"]=function(a){e.confirm("您确定要删除吗？",function(){r.deleteManager(a).then(function(a){o.showReturnMsg(a,"field.manager")})})},i.getRoleList(g).then(function(a){0==a.data.code?i.batchGetRole(a.data.data.ids).then(function(a){0==a.data.code?(l.roleList=a.data.data.roleList,l.roleList.push({id:-1,name:"全部角色"})):o.showErrMsg(a)}):o.showErrMsg(a)}),l.rid={},l.search=function(){l.rid<0?s():c(l.rid)}}]);